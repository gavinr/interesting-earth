import{bG as E,bH as b,bI as F,bJ as O,bK as P}from"./index-4b03b1b0.js";const g=2.4;function K(t){return E(t*g)}function L(t){return b(t)/g}function T(t,o,r,a){let{color:u,ratio:c}=o,{color:f,ratio:n}=r;n===c&&(n===1?c-=1e-6:n+=1e-6);const e=P((a-c)/(n-c),0,1);F(t,u.toArray(),f.toArray(),e)}function S(t){const r=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:n})=>n>=0&&n<=1).sort((n,e)=>n.ratio-e.ratio).map(({color:n,ratio:e})=>({color:n,ratio:Math.max(e,.001)})),t.length<1)return r;let a=t[0],u=t[0],c=1;const f=O();for(let n=0;n<512;n++){const e=(n+.5)/512;for(;e>u.ratio&&c<t.length;)a=u,u=t[c++];T(f,a,u,e),r.set(f,4*n)}return r}function U(t,o,r,a){const{radius:u,fieldOffset:c,field:f}=o,n=Math.round(b(u)),e=new Float64Array(r*a);let s,m=Number.NEGATIVE_INFINITY;const A=H(f,c),x=new Set;for(const p of t){const l=p.getCursor();for(;l.next();){const M=l.getObjectId();if(x.has(M))continue;x.add(M);const i=l.readLegacyPointGeometry(),d=128;if(i.x<-d||i.x>=r+d||i.y<-d||i.y>a+d)continue;const I=+A(l),N=Math.max(0,Math.round(i.x)-n),w=Math.max(0,Math.round(i.y)-n),G=Math.min(a,Math.round(i.y)+n),$=Math.min(r,Math.round(i.x)+n);for(let h=w;h<G;h++)for(let y=N;y<$;y++){const j=h*r+y,C=q(i.x-y,i.y-h,n);s=e[j]+=C*I,s>m&&(m=s)}}}return{matrix:e.buffer,max:m}}function q(t,o,r){const a=Math.sqrt(t**2+o**2)/r;return a>1?0:3/(Math.PI*r**2)*(1-a**2)**2}function V(t,o){return typeof t=="function"?t:t?typeof o=="string"?r=>-1*+r[t]:r=>+r[t]+o:()=>1}function H(t,o){return t!=null?typeof o=="string"?r=>-1*+r.readAttribute(t):r=>+r.readAttribute(t)+o:r=>1}export{g as a,L as c,K as i,q as m,U as s,S as u,V as y};
